{"ID":"20201227173504-847cs1q","Type":"NodeDocument","Properties":{"id":"20201227173504-847cs1q","type":"doc"},"Children":[{"ID":"20201227173504-opkavin","Type":"NodeParagraph","Properties":{"id":"20201227173504-opkavin","updated":"20210302223601"},"Children":[{"Type":"NodeText","Data":"在服务器上伺服思源笔记最简单的方案是通过 Docker 部署，镜像名称是 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"b3log/siyuan"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，目前没有版本标签，只有最新版。"}]},{"ID":"20201227174700-39dg7ur","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20201227174700-39dg7ur"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## "},{"Type":"NodeText","Data":"文件结构"}]},{"ID":"20201227174134-hptryqy","Type":"NodeParagraph","Properties":{"id":"20201227174134-hptryqy"},"Children":[{"Type":"NodeText","Data":"整体程序位于 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"/opt/siyuan/"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 下，基本上就是 Electron 安装包 resources 文件夹下的结构："}]},{"ID":"20201227174705-0hl54vz","Type":"NodeList","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174705-0hl54vz"},"Children":[{"ID":"20201227174714-t7ew8rk","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174714-t7ew8rk"},"Children":[{"ID":"20210208145140-jwvzb91","Type":"NodeParagraph","Properties":{"id":"20210208145140-jwvzb91"},"Children":[{"Type":"NodeText","Data":"appearance：图标、主题、多语言"}]}]},{"ID":"20201227174726-zztkpj2","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174726-zztkpj2"},"Children":[{"ID":"20210208145140-em39k3o","Type":"NodeParagraph","Properties":{"id":"20210208145140-em39k3o"},"Children":[{"Type":"NodeText","Data":"guide：帮助文档"}]}]},{"ID":"20201227174744-z7qo4j2","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174744-z7qo4j2"},"Children":[{"ID":"20210208145140-1tyrmez","Type":"NodeParagraph","Properties":{"id":"20210208145140-1tyrmez"},"Children":[{"Type":"NodeText","Data":"stage：界面和静态资源"}]}]},{"ID":"20201227174842-tr8u7q0","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174842-tr8u7q0"},"Children":[{"ID":"20210208145140-99h8xv0","Type":"NodeParagraph","Properties":{"id":"20210208145140-99h8xv0"},"Children":[{"Type":"NodeText","Data":"kernel：内核程序"}]}]}]},{"ID":"20201227174908-s19h988","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20201227174908-s19h988"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## "},{"Type":"NodeText","Data":"启动入口"}]},{"ID":"20201227180709-rglrztt","Type":"NodeParagraph","Properties":{"id":"20201227180709-rglrztt","updated":"20210301202239"},"Children":[{"Type":"NodeText","Data":"构建 Docker 镜像时设置了入口："},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"ENTRYPOINT [ \"/opt/siyuan/kernel\" ]"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，使用 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"docker run b3log/siyuan"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 并带参即可启动："}]},{"ID":"20201227201453-yh75kqd","Type":"NodeList","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227201453-yh75kqd"},"Children":[{"ID":"20201227201514-c7brkss","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227201514-c7brkss"},"Children":[{"ID":"20210208145140-7f45i9c","Type":"NodeParagraph","Properties":{"id":"20210208145140-7f45i9c","updated":"20210502164159"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"--workspace"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 指定工作空间文件夹路径，在宿主机上通过 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"-v"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 挂载到容器中"}]}]},{"ID":"20201227201521-fs7hlwf","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227201521-fs7hlwf"},"Children":[{"ID":"20210208145140-tgabyhf","Type":"NodeParagraph","Properties":{"id":"20210208145140-tgabyhf"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"--resident"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 指定为 true 常驻内存"}]}]}]},{"ID":"20210301201353-sffb1m7","Type":"NodeParagraph","Properties":{"id":"20210301201353-sffb1m7","updated":"20210502164429"},"Children":[{"Type":"NodeText","Data":"更多的参数可参考"},{"Type":"NodeBlockRef","Children":[{"Type":"NodeOpenParen"},{"Type":"NodeOpenParen"},{"Type":"NodeBlockRefID","Data":"20201225172241-ifgc4hm"},{"Type":"NodeBlockRefSpace"},{"Type":"NodeBlockRefText","Data":"这里"},{"Type":"NodeCloseParen"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"。下面是一条启动命令示例："},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"docker run -v workspace_dir_host:workspace_dir_container -p 6806:6806 b3log/siyuan --resident=true --workspace=workspace_dir_container"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]}]},{"ID":"20201227174657-0k1ruhd","Type":"NodeList","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227174657-0k1ruhd"},"Children":[{"ID":"20201227193950-dp2hioi","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227193950-dp2hioi"},"Children":[{"ID":"20210208145140-w9i02jr","Type":"NodeParagraph","Properties":{"id":"20210208145140-w9i02jr","updated":"20210502164152"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"workspace_dir_host"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"：宿主机上的工作空间文件夹路径"}]}]},{"ID":"20201227194032-68h45ue","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227194032-68h45ue"},"Children":[{"ID":"20210208145140-2ave4tv","Type":"NodeParagraph","Properties":{"id":"20210208145140-2ave4tv","updated":"20210502164311"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"workspace_dir_container"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"：容器内工作空间文件夹路径，和后面 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"--workspace"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 指定成一样的"}]}]}]},{"ID":"20201227194509-hdnzkry","Type":"NodeParagraph","Properties":{"id":"20201227194509-hdnzkry","updated":"20210502171807"},"Children":[{"Type":"NodeText","Data":"为了简化，建议将 workspace 文件夹路径在宿主机和容器上配置为一致的，比如将 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"workspace_dir_host"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 和 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"workspace_dir_container"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":" 都配置为 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"/siyuan/workspace"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，对应的启动命令示例："},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"docker run -v /siyuan/workspace:/siyuan/workspace -p 6806:6806 b3log/siyuan --resident=true --workspace=/siyuan/workspace/"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]}]},{"ID":"20201227194925-7ipoiv6","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20201227194925-7ipoiv6"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## "},{"Type":"NodeText","Data":"内核 API"}]},{"ID":"20201227195443-zxgp2sw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20201227195443-zxgp2sw"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### "},{"Type":"NodeText","Data":"打开文件夹"}]},{"ID":"20201227195224-cnwhfri","Type":"NodeParagraph","Properties":{"id":"20201227195224-cnwhfri"},"Children":[{"Type":"NodeText","Data":"POST "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"/notebook/mount"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，参数："}]},{"ID":"20201227195500-v08m84n","Type":"NodeList","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227195500-v08m84n"},"Children":[{"ID":"20201227195626-jsv1r80","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227195626-jsv1r80"},"Children":[{"ID":"20210208145140-lxewxwx","Type":"NodeParagraph","Properties":{"id":"20210208145140-lxewxwx"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"url"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"：固定传入 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"http://127.0.0.1:6806/siyuan/"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，即 box.url"}]}]},{"ID":"20201227195644-i7xcm1g","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227195644-i7xcm1g"},"Children":[{"ID":"20210208145140-vcsnpch","Type":"NodeParagraph","Properties":{"id":"20210208145140-vcsnpch"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"path"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"：内核数据文件夹下的某个文件夹路径，即 box.path"}]}]}]},{"ID":"20201227195737-xbkf95m","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20201227195737-xbkf95m"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### "},{"Type":"NodeText","Data":"关闭文件夹"}]},{"ID":"20201227195742-df6gznf","Type":"NodeParagraph","Properties":{"id":"20201227195742-df6gznf"},"Children":[{"Type":"NodeText","Data":"POST "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"/notebook/unmount"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，参数："}]},{"ID":"20201227195758-qsyk4py","Type":"NodeList","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227195758-qsyk4py"},"Children":[{"ID":"20201227195805-rq7h6m9","Type":"NodeListItem","Data":"*","ListData":{"Tight":true,"BulletChar":42,"Padding":2,"Marker":"Kg==","Num":-1},"Properties":{"id":"20201227195805-rq7h6m9"},"Children":[{"ID":"20210208145140-qaqj3jl","Type":"NodeParagraph","Properties":{"id":"20210208145140-qaqj3jl"},"Children":[{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"url"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"：固定传入 "},{"Type":"NodeCodeSpan","CodeMarkerLen":1,"Children":[{"Type":"NodeCodeSpanOpenMarker","Data":"`"},{"Type":"NodeCodeSpanContent","Data":"http://127.0.0.1:6806/siyuan/"},{"Type":"NodeCodeSpanCloseMarker","Data":"`"}]},{"Type":"NodeText","Data":"，即 box.url"}]}]}]}]}